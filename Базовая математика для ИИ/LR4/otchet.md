# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4: –°–∞–º–æ–ø–∏—Å–Ω—ã–π MLP –Ω–∞ CPU

## 1. –í—ã–±—Ä–∞–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç

**–î–∞—Ç–∞—Å–µ—Ç:** Breast Cancer Wisconsin (Diagnostic)  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** UCI Machine Learning Repository  

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- **–†–∞–∑–º–µ—Ä:** 569 –æ–±—Ä–∞–∑—Ü–æ–≤
- **–ü—Ä–∏–∑–Ω–∞–∫–∏:** 30 —á–∏—Å–ª–æ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —è–¥–µ—Ä –∫–ª–µ—Ç–æ–∫, –≤–∫–ª—é—á–∞—è:
  - radius (—Ä–∞–¥–∏—É—Å)
  - texture (—Ç–µ–∫—Å—Ç—É—Ä–∞) 
  - perimeter (–ø–µ—Ä–∏–º–µ—Ç—Ä)
  - area (–ø–ª–æ—â–∞–¥—å)
  - smoothness (–≥–ª–∞–¥–∫–æ—Å—Ç—å)
  - compactness (–∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç—å)
  - concavity (–≤–æ–≥–Ω—É—Ç–æ—Å—Ç—å)
  - concave points (–≤–æ–≥–Ω—É—Ç—ã–µ —Ç–æ—á–∫–∏)
  - symmetry (—Å–∏–º–º–µ—Ç—Ä–∏—è)
  - fractal dimension (—Ñ—Ä–∞–∫—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å)
- **–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:** –î–∏–∞–≥–Ω–æ–∑ (0 - –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è, 1 - –¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è)
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤:** 357 –¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö (62.7%), 212 –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö (37.3%)

## 2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏:**
1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** 60% –æ–±—É—á–∞—é—â–∞—è, 20% –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è, 20% —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞
2. **–°—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**  –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –≤–æ –≤—Å–µ—Ö –≤—ã–±–æ—Ä–∫–∞—Ö

```
# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
X_train, X_temp, y_train, y_temp = train_test_split(
    X, y, test_size=0.4, stratify=y, random_state=42
)
X_val, X_test, y_val, y_test = train_test_split(
    X_temp, y_temp, test_size=0.5, stratify=y_temp, random_state=42
)

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_val = scaler.transform(X_val)
X_test = scaler.transform(X_test)
```

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MLP:**
```
–í—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π: 30 –Ω–µ–π—Ä–æ–Ω–æ–≤ (–ø–æ —á–∏—Å–ª—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
‚Üì
–°–∫—Ä—ã—Ç—ã–π —Å–ª–æ–π 1: 64 –Ω–µ–π—Ä–æ–Ω–∞, ReLU –∞–∫—Ç–∏–≤–∞—Ü–∏—è
‚Üì  
–°–∫—Ä—ã—Ç—ã–π —Å–ª–æ–π 2: 32 –Ω–µ–π—Ä–æ–Ω–∞, ReLU –∞–∫—Ç–∏–≤–∞—Ü–∏—è
‚Üì
–í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π: 1 –Ω–µ–π—Ä–æ–Ω, Sigmoid –∞–∫—Ç–∏–≤–∞—Ü–∏—è
```

**–ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **Learning rate:** 0.01
- **Momentum:** 0.9
- **L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è:** 0.001
- **–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞:** –ü–æ–ª–Ω—ã–π –±–∞—Ç—á (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö:** 1000
- **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤:** Xavier/Glorot
- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å:** –ë–∏–Ω–∞—Ä–Ω–∞—è –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏—è + L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è

## 4. –ö—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è

**–ù–∞–±–ª—é–¥–µ–Ω–∏—è:**
- **–°—Ö–æ–¥–∏–º–æ—Å—Ç—å:** –ú–æ–¥–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —É—Å—Ç–æ–π—á–∏–≤—É—é —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ—Å–ª–µ ~200 —ç–ø–æ—Ö
- **–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ:** L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–º–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –ø–æ—Ç–µ—Ä—è–º–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞
- **–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è:** Momentum —É—Å–∫–æ—Ä—è–µ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å

**–ú–µ—Ç—Ä–∏–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è:**
```
Epoch 0:   Train Loss: 0.6813, Val Loss: 0.6775, Train Acc: 0.6316, Val Acc: 0.6579
Epoch 100: Train Loss: 0.1562, Val Loss: 0.1621, Train Acc: 0.9474, Val Acc: 0.9386
Epoch 200: Train Loss: 0.0987, Val Loss: 0.1083, Train Acc: 0.9649, Val Acc: 0.9561
...
Epoch 900: Train Loss: 0.0641, Val Loss: 0.0789, Train Acc: 0.9825, Val Acc: 0.9737
```

## 5. –ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- **Accuracy:** 0.9737 (97.37%)
- **ROC-AUC:** 0.9958 (99.58%)
- **F1-Score:** 0.9796

**Classification Report:**
```
              precision    recall  f1-score   support

   malignant       0.96      0.98      0.97        43
      benign       0.99      0.97      0.98        71

    accuracy                           0.97       114
   macro avg       0.97      0.98      0.97       114
weighted avg       0.97      0.97      0.97       114
```

**–ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫:**
```
[[42  1]   ‚Üí 42 –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö
 [ 2 69]]  ‚Üí 1 –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π, 2 –ª–æ–∂–Ω–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö
```

## 6. –í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ ùúè

**–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ—Ä–æ–≥–æ–≤:**
- **–î–∏–∞–ø–∞–∑–æ–Ω –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:** ùúè ‚àà [0.1, 0.9] —Å —à–∞–≥–æ–º 0.05
- **–ö—Ä–∏—Ç–µ—Ä–∏–π –≤—ã–±–æ—Ä–∞:** –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è F1-Score
- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:** Youden's J statistic, –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Ä–æ–≥–æ–≤:**

| –ü–æ—Ä–æ–≥ (ùúè) | Accuracy | Precision | Recall | F1-Score |
|-----------|----------|-----------|--------|-----------|
| 0.3       | 0.9649   | 0.9714    | 0.9714 | 0.9714    |
| 0.4       | 0.9737   | 0.9859    | 0.9714 | 0.9786    |
| **0.5**   | **0.9737** | **0.9859** | **0.9714** | **0.9786** |
| 0.6       | 0.9737   | 0.9859    | 0.9714 | 0.9786    |
| 0.7       | 0.9649   | 1.0000    | 0.9429 | 0.9706    |

**–í—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ—Ä–æ–≥:** ùúè = 0.5

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞:**
1. **–ë–∞–ª–∞–Ω—Å –º–µ—Ç—Ä–∏–∫:** –ü–æ—Ä–æ–≥ 0.5 –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É precision –∏ recall
2. **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è - –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–ª–∞—Å—Å—É 1
3. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** F1-Score –æ—Å—Ç–∞–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–º –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ ùúè ‚àà [0.4, 0.6]
4. **–ö–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å:** –í –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –≤–∞–∂–Ω—ã –∫–∞–∫ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö, —Ç–∞–∫ –∏ –ª–æ–∂–Ω–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## 7. –í—ã–≤–æ–¥—ã –∏ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ

**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏:**
- –°–∞–º–æ–ø–∏—Å–Ω—ã–π MLP –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ—Ç–ª–∏—á–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –∑–∞–¥–∞—á–µ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –î–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —Ç–æ—á–Ω–æ—Å—Ç—å 97.37%, —á—Ç–æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
- ROC-AUC 0.9958 —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω—É—é —Ä–∞–∑–¥–µ–ª—è—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã —É—Å–ø–µ—Ö–∞:**
1. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è)
2. –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ç–∏
3. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (L2 + —Ä–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ momentum –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
- –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏ —Å–µ—Ç–µ–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ mini-batch gradient descent
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ (Dropout)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

